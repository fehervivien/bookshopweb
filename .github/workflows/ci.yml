name: Java CI with Maven # A workflow neve, ami megjelenik a GitHub Actions UI-ban

on:
  push:
    branches:
      - master # Fut, ha push történik a master ágra
  pull_request:
    branches:
      - master # Fut, ha pull request történik a master ágra

jobs:
  build: # A job neve
    runs-on: ubuntu-latest # A futtató környezet

    steps:
      - name: Checkout code # A kód klónozása a futtatóra
        uses: actions/checkout@v4 # Frissítettük a v2-ről v4-re (ajánlott a legújabb stabil verzió)

      - name: Set up JDK 17 # JDK 17 beállítása
        uses: actions/setup-java@v4 # Frissítettük a v2-ről v4-re
        with:
          java-version: '17' # Megtartjuk a Java 17-et, ahogy kérted
          distribution: 'temurin'
          cache: 'maven' # Maven cache beállítása a gyorsabb build-ekhez

      - name: Build and Test with Maven # Kód fordítása és tesztelése Maven-nel
        run: mvn clean install -DskipTests=false
        # Módosítva: eltávolítottuk a vezető './' karaktert.
        # Így a GitHub Actions a repository gyökeréhez képest fogja keresni a 'bookshopweb' mappát.
        working-directory: bookshopweb

      - name: Upload the packaged code # A csomagolt JAR fájl feltöltése artifactként
        uses: actions/upload-artifact@v4
        with:
          name: app-jar
          # A JAR fájl útvonala a working-directory figyelembevételével
          # Mivel a 'bookshopweb' lett a working-directory, a target mappa azon belül lesz.
          # Így a 'bookshopweb/' előtagot kell használni a gyökér repositoryhoz képest.
          path: /target/*.jar